@{
    ViewBag.Title = "View classroom";
    Layout = null;
}
@using StudentDashboard.Models.Instructor;
@model JitsiMeetingModal
<script src='https://goodpathshala.com/external_api.js'></script>
<script src="../../Scripts/vendor/jquery/jquery.min.js"></script>
<div id="meet"></div>
<script>
    $.ajax({
        headers: { "Authorization": 'Bearer ' + localStorage.getItem('jwttoken') },
        type: "POST",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        url: "/api/v1/Course/JoinClassroomMeeting?MeetingId=".concat("@Model.m_llMeetingId"),
        success: function (data) {
            if (data != null && data.response_code == 1) {

            }
        }
    });
    const domain = 'meet.jit.si';
    const options = {
        roomName: "@Model.m_strMeetingName",
        parentNode: document.querySelector('#meet'),
    };
    const api = new JitsiMeetExternalAPI(domain, options);
    @*api.addEventListener('participantRoleChanged', function (event) {
        if (event.role === "moderator") {
            api.executeCommand('password', "@Model.m_strMeetingPassword");
        }
    });*@
    //join a protected channel
    api.on('passwordRequired', function () {
        api.executeCommand('password', "@Model.m_strMeetingPassword");
    });
    api.executeCommand('subject', "@Model.m_strMeetingTopic");
    api.executeCommand('toggleAudio');
    api.executeCommand('toggleVideo');
    //api.executeCommand('avatarUrl', 'https://readmycourse.com/Images/site-logo.png');
    const meetingId = "@Model.m_llMeetingId";
    api.on("participantJoined",
        (object) =>
            $.ajax({
                headers: { "Authorization": 'Bearer ' + localStorage.getItem('jwttoken') },
                type: "POST",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                url: "/api/v1/course/JoinClassroomMeeting?MeetingId=".concat("@Model.m_llMeetingId"),
                success: function (data) {
                    if (data != null && data.response_code == 1) {

                    }
                }
            })
        );
 
</script>